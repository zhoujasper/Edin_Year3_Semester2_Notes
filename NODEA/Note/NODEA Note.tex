\documentclass[9pt]{article}

\usepackage{graphicx} % Required for inserting images
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{ctex}
\usepackage{enumitem}
\usepackage{longtable}
\usepackage{makecell} % 换行

% 使用分栏宏包
\usepackage{multicol} 
\setlength{\columnseprule}{0.4pt} % 分割线

% 设置字体
\usepackage{unicode-math}
\setmainfont{Cambria}
\setmathfont{Cambria Math}

% 调整页面布局
\usepackage[a4paper, top=0.7cm, bottom=1cm, left=0.7cm, right=.7cm]{geometry}
\setlength{\footskip}{15pt}

% 设置页脚/页眉
\usepackage{fancyhdr}
\fancyfoot[C]{Copyright By Jingren Zhou | Page \thepage}
\fancyhead[]{}
\pagestyle{fancy}
% 去除线
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

% 设置 section/subsection 之间的行间距
\usepackage{titlesec}
\titlespacing*{\section}{0pt}{0pt}{0pt}
\titlespacing*{\subsection}{0pt}{0pt}{0pt}

% 调整标题上下间距
\usepackage{titling}
\setlength{\droptitle}{-2.4cm} % 负值表示向上移动

% 设置标题，作者，时间
\title{NODEA Note}
\author{}
\date{}

% 正文
\begin{document}


% 标题
\maketitle
\thispagestyle{fancy}
\vspace{-3.5cm}

% 字体大小
\fontsize{10pt}{11pt}\selectfont
\setlength{\parindent}{8pt}


\section{Basic Knowledge} % Basic Knowledge

\textbf{Def of ODE \& ODEs}: {\scriptsize (1st order)} ODE: $\frac{dy}{dt}=f(t,y)$ \quad \& \quad ODEs: $\frac{d\mathbf{y}}{dt}=\mathbf{f}(t,\mathbf{y})$ , {\footnotesize $\mathbf{y}=(y_1,...,y_d)^T,\mathbf{f}(t,\mathbf{y})=(f_1(t,\mathbf{y}),...,f_d(t,\mathbf{y}))^T$}

\textbf{Autonomous}: $\frac{d\mathbf{y}}{dt}=\mathbf{f}(\mathbf{y})$ \ $\Rightarrow$ \ autonomous ODE(s). \quad \quad \quad || $\Downarrow$ New Autonomous ODEs: $\frac{d\mathbf{y}}{ds}=\mathbf{f}(y_{d+1},\mathbf{y})$ and $\frac{dy_{d+1}}{ds}=1$

$\cdot$ \textbf{Change to Autonomous}: For $\frac{d\mathbf{y}}{dt}=\mathbf{f}(t,\mathbf{y})$. Let $y_{d+1}=t$ and \textit{new} independent variable $s$ s.t. $\frac{dt}{ds}=1$ $\Uparrow$

\textbf{Linearity}: ODE: $\frac{dy}{dt}=f(t,y)$ is linearity if $f(t,y)=a(t)y+b(t)$ \quad || ODEs: {\small If each ODE is linear, then the ODEs are linear.}

\textbf{Picard's Theorem}: If $f(t,y)$ is continuous in $D:=\{(t,y):t_0\leq t\leq T,|y-y_0|<K\}$ and $\exists L>0$ {\footnotesize (Lipschitz constant)} s.t.

$\quad$ $\forall (t,u),(t,v)\in D \quad|f(t,u)-f(t,v)|\leq L|u-v|$ {\tiny (ps:Can use MVT)}. And Assume that $M_f(T-t_0)\leq K,M_f:=\max\{|f(t,u)|:(t,u)\in D\}$

$\quad$ $\Rightarrow$ \textbf{Then}, $\exists$ a unique continuously differentiable solution $y(t)$ to the IVP $\frac{dy}{dt}=f(t,y),y(t_0)=y_0$ on $t\in[t_0,T]$.

\textbf{Existence \& Uniqueness Theorem}: IVP $\frac{d\mathbf{y}}{dt}=\mathbf{f}(t,\mathbf{y}),\mathbf{y}(t_0)=\mathbf{y}_0$. If $f(t,y)$ and $\frac{\partial f}{\partial y_i}$ are continuous in a neighborhood of $(t_0,\mathbf{y}_0)$.

$\quad$ $\Rightarrow$ \textbf{Then}, $\exists I:=(t_0-\delta,t_0+\delta)$ s.t. $\exists$ a unique continuously differentiable solution $\mathbf{y}(t)$ to the IVP on $t\in I$.


\section{Acknowledge} % Acknowledge

\vspace{-10pt}
\begin{longtable}{|c|l||c|l|}
    \hline
    Notation & Meaning & Notation & Meaning \\
    \hline
    \hline
    $[a,b]$ & Approximate function for $t\in[a,b]$ & {\footnotesize $t_0=a \ | \ t_N=b$} & Assume that $t_0=a,t_N=b$ \\
    \hline
    $N$ & number of \textbf{timesteps} \ \ {\tiny (i.e. Break up interval $[a,b]$ into $N$ equal-length sub-intervals)} & $h$ & \textbf{stepsize} \ \ {\scriptsize ($h=\frac{b-a}{N}$)} \\
    \hline
    $t_i$ & Define $N+1$ points: $t_0,t_1,...,t_N$ & $t_m$ & $t_m=a+h\cdot m=t_0+h\cdot m$ \\
    \hline
    $y_i$ & Approximation of $y$ at point $t=t_i$ \ \ (Except $y_0$) & $y(t_i)$ & Exact value of $y$ at point $t=t_i$ \\
    \hline
\end{longtable}
\vspace{-10pt}


\section{Euler's Method and Taylor Series Method} % Euler's Method and Taylor Series Method

\textbf{Euler's Method Algorithm}: Approximate ODE $\frac{dy}{dt}=f(t,y),y(t_0)=y_0$ with number of steps $N$. \ (Similarly for ODEs)

\hspace{20pt} $\Rightarrow$
\textbf{for} $n=0,1,2,...,N-1$:
\quad $y_{n+1}=y_n+hf(t_0+nh,y_n)=y_n+hf(t_n,y_n)$ \quad 
\textbf{end} \hspace{100pt} {\scriptsize (ps: $\Downarrow$ Can get $|y''|<M$)}

\textbf{Boundedness Theorem}: {\small For $\frac{dy}{dt}=f(t,y),y(a)=y_0$ and suppose there exists a unique, twice differentiable, solution $y(t)$ on $[a,b]$.}

\quad \quad \quad {\small Suppose: $y$ is continuous and $|\frac{\partial f}{\partial y}|\leq L$. \ $\Rightarrow$ \ the solution $y_n$ given Euler's method satisfies: $e_n=|y_n-y(t_n)|\leq Dh,D=e^{(b-a)L}\frac{M}{2L}$}

$\cdot$ \textbf{Lemma}: If $v_{n+1}\leq Av_n+B$, then $v_n\leq A^nv_0+\frac{A^n-1}{A-1}B$ \quad If $v_{n}=e_n:=y_n-y(t_n)$, then $A=1+hL,B=h^2M/2$ {\scriptsize (suppose $|y''|<M$)}

\textbf{Order Notation ($\mathcal{O}$)}: we write $z(h)=\mathcal{O}(h^p)$ if $\exists C,h_0>0$ s.t. $|z|\leq Ch^p,0<h<h_0$

\textbf{Flow Map ($\Phi$)}: {\small $\Phi_h(y)$ is a flow function if: $\Phi_{t_0,h}(y)=y(t_0+h;t_0,y_0)$} \quad {\small Approx: $\Psi_h(y):=\widehat{\Phi}_h(y)$ where $\Psi(y_n)=y_{n+1}$}

\textbf{Taylor Series Method}: {\small Approximate ODE $\frac{dy}{dt}=f(t,y),y(t_0)=y_0$ with \textit{n-order Methods}: 用 Taylor Series 在 $t_0+h$ 处展开 保留到 $n$ 阶}

$\cdot$ ps: {\footnotesize Taylor Series: $y(t_0+h)=y(t_0)+hy'(t_0)+\frac{h^2}{2}y''(t_0)+\cdots+\frac{h^{n-1}}{(n-1)!}y^{(n-1)}(t_0)+\frac{h^n}{n!}y^{(n)}(t^*),t^*\in[t,t+h]$ \quad $y'=f,y''=f_t+f_yf$}


\section{Convergence of One-Step Methods {\scriptsize consider for autonomous $y'=f(y)$}}

\textbf{Global Error}: global error after $n$ steps: $e_n:=y_n-y(t_n)$ \quad \textbf{Local Error}: {\small For \textit{one-step} method is: $le(y,h)=\Psi_h(y)-\Phi_h(y)$}

\textbf{Consistent}: {\small If $||le(y,h)||<Ch^{p+1} (<\mathcal{O}(h^{p+1})), \ C>0$. $\Rightarrow$ Consistent at order $p$.} \quad \textbf{Stable}: If $||\Psi_h(u)-\Psi_h(v)||\leq(1+h\widehat{L})||u-v||$

\textbf{Convergent}: {\small A method is convergent if:$\forall \ T$, $\lim\limits_{h\to0,\ h=T/N}\max\limits_{n=0,1,...,N}||e_n||=0$} \quad \quad \quad {\small $\Downarrow$ Then the global error satisfies: $\max\limits_{n=0,1,...,N}||e_n||=\mathcal{O}(h^p)$} \ {\tiny \textbf{p-th order}}

\vspace{-2pt}
\textbf{Convergence of One-Step Method}: {\small For $y'=f(y)$, and a one-step method $\Psi_h(y)$ is $^1$ consistent at order $p$ and $^2$ stable with $\widehat{L}\Uparrow$.} \ {\tiny (ps:$C=\frac{C}{\widehat{L}}(e^{T\widehat{L}}-1)$)}

\textbf{Construction of More General one-step Method}: For $y'=f(y),y(t_0)=y_0$ \ $\Rightarrow$ \ $y(t+h)-y(t)=\int^{t+h}_tf(y(\tau))d\tau$

\textbf{Polynomial Interpolation}: For $P(x)\in\mathbb{P}_{s-1}$, if $P(c_i)=g_i,\forall i\in\{1,...,\mathbf{s}\}$. Then $P(x)$ is the \textit{unique} interpolating polynomial.

$\cdot$ \textbf{Lagrange interpolating Polynomials}: $\ell_{i}(x)=\prod\limits_{j=1,j\ne i}^{s}\frac{x-c_j}{c_i-c_j}$ \quad \quad $\Rightarrow$ $P(x)$ can be written as: $P(x)=\sum\limits_{i=1}^{s}g_i\ell_i(x)$

\vspace{-2pt}
$\cdot$ \textbf{Quadrature Rule}: {\small $\int^{t_0+h}_{t_0}g(t)dt=\int^1_0g(t_0+hx)dx\approx h\sum_{i=1}^{s}b_ig(t_0+hc_i),b_i:=\int^1_0\ell_i(x)dx$} \quad {\tiny ps: $c_i\to g_i$ 从 $[0,1]$中取} \quad {\tiny If $g(t)\in\mathbb{P}_{p-1}\Rightarrow$Quadrature Rule has order $p$}

\textbf{One-Step Collocation Methods}: For: $y(t_0)=y_0 \ , \ y'(t_0+c_ih)=f(y(t_0+c_ih))$, $c_i$ are chosen nodes in $[0,1]$ \ $i\in\{1,...,s\}$

{\small $\Rightarrow$ \ Def $\ell_i(x)$ \ , \ $a_{ij}:=\int_0^{c_i}\ell_j(x)dx$ \ , \ $b_i:=\int_0^1\ell_i(x)dx$ \ , \ $F_i:=y'(t_0+c_ih)$} \quad Then: $F_i=f(y_n+h\sum_{j=1}^{s}a_{ij}F_j)$ and $y_{n+1}=y_n+h\sum_{i=1}^{s}b_iF_i$

$\cdot$ \textbf{Remark}: {\footnotesize For choice of $c_i$: The optimal choice is attained by \textit{Gauss-Legendre collocation methods}}.


\section{Appendix} 

\small
$e^x = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \cdots  = \sum_{n=0}^\infty \frac{x^n}{n!}$ \quad $ \sin(x) = x - \frac{x^3}{3!} + \frac{x^5}{5!} + \cdots = \sum_{n=0}^\infty (-1)^n \frac{x^{2n+1}}{(2n+1)!} $ \quad $\cos(x) = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} + \cdots = \sum_{n=0}^\infty (-1)^n \frac{x^{2n}}{(2n)!}$

$\ln(1+x) = x - \frac{x^2}{2} + \frac{x^3}{3}  + \cdots = \sum_{n=1}^\infty (-1)^{n+1} \frac{x^n}{n}$ \quad $\arctan(x) = x - \frac{x^3}{3} + \frac{x^5}{5} + \cdots = \sum_{n=0}^\infty (-1)^n \frac{x^{2n+1}}{2n+1}$ \quad $\sinh(x) = x + \frac{x^3}{3!} + \frac{x^5}{5!} + \cdots = \sum_{n=0}^\infty \frac{x^{2n+1}}{(2n+1)!}$

$\cosh(x) = 1 + \frac{x^2}{2!} + \frac{x^4}{4!} + \cdots = \sum_{n=0}^\infty \frac{x^{2n}}{(2n)!}$  \quad $(1+x)^k = 1 + kx + \frac{k(k-1)x^2}{2!} + \cdots = \sum_{n=0}^\infty \binom{k}{n} x^n$ $\frac{1}{1-x} = 1 + x + x^2  + \cdots = \sum_{n=0}^\infty x^n $ 

$\frac{1}{1+x} = 1 - x + x^2  + \cdots = \sum_{n=0}^\infty (-1)^n x^n$ \quad $\ln(x) = (x-1) - \frac{(x-1)^2}{2} - \cdots = \sum_{n=1}^\infty (-1)^{n+1} \frac{(x-1)^n}{n}, \, x > 0$


\end{document}