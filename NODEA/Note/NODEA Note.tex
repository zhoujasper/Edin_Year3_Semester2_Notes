\documentclass[9pt]{article}

\usepackage{graphicx} % Required for inserting images
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{ctex}
\usepackage{enumitem}
\usepackage{longtable}
\usepackage{makecell} % 换行

% 使用分栏宏包
\usepackage{multicol} 
\setlength{\columnseprule}{0.4pt} % 分割线

% 设置字体
\usepackage{unicode-math}
\setmainfont{Cambria}
\setmathfont{Cambria Math}

% 调整页面布局
\usepackage[a4paper, top=0.7cm, bottom=1cm, left=0.7cm, right=.7cm]{geometry}
\setlength{\footskip}{15pt}

% 设置页脚/页眉
\usepackage{fancyhdr}
\fancyfoot[C]{Copyright By Jingren Zhou | Page \thepage}
\fancyhead[]{}
\pagestyle{fancy}
% 去除线
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

% 设置 section/subsection 之间的行间距
\usepackage{titlesec}
\titlespacing*{\section}{0pt}{0pt}{0pt}
\titlespacing*{\subsection}{0pt}{0pt}{0pt}

% 调整标题上下间距
\usepackage{titling}
\setlength{\droptitle}{-2.4cm} % 负值表示向上移动

% 设置标题，作者，时间
\title{NODEA Note}
\author{}
\date{}

% 正文
\begin{document}


% 标题
\maketitle
\thispagestyle{fancy}
\vspace{-3.5cm}

% 字体大小
\fontsize{10pt}{11pt}\selectfont
\setlength{\parindent}{8pt}


\section{Basic Knowledge} % Basic Knowledge

\textbf{Def of ODE \& ODEs}: {\scriptsize (1st order)} ODE: $\frac{dy}{dt}=f(t,y)$ \quad \& \quad ODEs: $\frac{d\mathbf{y}}{dt}=\mathbf{f}(t,\mathbf{y})$ , {\footnotesize $\mathbf{y}=(y_1,...,y_d)^T,\mathbf{f}(t,\mathbf{y})=(f_1(t,\mathbf{y}),...,f_d(t,\mathbf{y}))^T$}

\textbf{Autonomous}: $\frac{d\mathbf{y}}{dt}=\mathbf{f}(\mathbf{y})$ \ $\Rightarrow$ \ autonomous ODE(s). \quad \quad \quad || $\Downarrow$ New Autonomous ODEs: $\frac{d\mathbf{y}}{ds}=\mathbf{f}(y_{d+1},\mathbf{y})$ and $\frac{dy_{d+1}}{ds}=1$

$\cdot$ \textbf{Change to Autonomous}: For $\frac{d\mathbf{y}}{dt}=\mathbf{f}(t,\mathbf{y})$. Let $y_{d+1}=t$ and \textit{new} independent variable $s$ s.t. $\frac{dt}{ds}=1$ $\Uparrow$

\textbf{Linearity}: ODE: $\frac{dy}{dt}=f(t,y)$ is linearity if $f(t,y)=a(t)y+b(t)$ \quad || ODEs: {\small If each ODE is linear, then the ODEs are linear.}

\textbf{Picard's Theorem}: If $f(t,y)$ is continuous in $D:=\{(t,y):t_0\leq t\leq T,|y-y_0|<K\}$ and $\exists L>0$ {\footnotesize (Lipschitz constant)} s.t.

$\quad$ $\forall (t,u),(t,v)\in D \quad|f(t,u)-f(t,v)|\leq L|u-v|$ {\tiny (ps:Can use MVT)}. And Assume that $M_f(T-t_0)\leq K,M_f:=\max\{|f(t,u)|:(t,u)\in D\}$

$\quad$ $\Rightarrow$ \textbf{Then}, $\exists$ a unique continuously differentiable solution $y(t)$ to the IVP $\frac{dy}{dt}=f(t,y),y(t_0)=y_0$ on $t\in[t_0,T]$.

\textbf{Existence \& Uniqueness Theorem}: IVP $\frac{d\mathbf{y}}{dt}=\mathbf{f}(t,\mathbf{y}),\mathbf{y}(t_0)=\mathbf{y}_0$. If $f(t,y)$ and $\frac{\partial f}{\partial y_i}$ are continuous in a neighborhood of $(t_0,\mathbf{y}_0)$.

$\quad$ $\Rightarrow$ \textbf{Then}, $\exists I:=(t_0-\delta,t_0+\delta)$ s.t. $\exists$ a unique continuously differentiable solution $\mathbf{y}(t)$ to the IVP on $t\in I$.


\section{Acknowledge} % Acknowledge

\vspace{-10pt}
\begin{longtable}{|c|l||c|l|}
    \hline
    Notation & Meaning & Notation & Meaning \\
    \hline
    \hline
    $[a,b]$ & Approximate function for $t\in[a,b]$ & {\footnotesize $t_0=a \ | \ t_N=b$} & Assume that $t_0=a,t_N=b$ \\
    \hline
    $N$ & number of \textbf{timesteps} \ \ {\tiny (i.e. Break up interval $[a,b]$ into $N$ equal-length sub-intervals)} & $h$ & \textbf{stepsize} \ \ {\scriptsize ($h=\frac{b-a}{N}$)} \\
    \hline
    $t_i$ & Define $N+1$ points: $t_0,t_1,...,t_N$ & $t_m$ & $t_m=a+h\cdot m=t_0+h\cdot m$ \\
    \hline
    $y_i$ & Approximation of $y$ at point $t=t_i$ \ \ (Except $y_0$) & $y(t_i)$ & Exact value of $y$ at point $t=t_i$ \\
    \hline
\end{longtable}
\vspace{-10pt}


\section{Euler's Method and Taylor Series Method} % Euler's Method and Taylor Series Method

\textbf{Euler's Method Algorithm}: Approximate ODE $\frac{dy}{dt}=f(t,y),y(t_0)=y_0$ with number of steps $N$. \ (Similarly for ODEs)

\hspace{20pt} $\Rightarrow$
\textbf{for} $n=0,1,2,...,N-1$:
\quad $y_{n+1}=y_n+hf(t_0+nh,y_n)=y_n+hf(t_n,y_n)$ \quad 
\textbf{end} \hspace{100pt} {\scriptsize (ps: $\Downarrow$ Can get $|y''|<M$)}

\textbf{Boundedness Theorem}: {\small For $\frac{dy}{dt}=f(t,y),y(a)=y_0$ and suppose there exists a unique, twice differentiable, solution $y(t)$ on $[a,b]$.}

\quad \quad \quad {\small Suppose: $y$ is continuous and $|\frac{\partial f}{\partial y}|\leq L$. \ $\Rightarrow$ \ the solution $y_n$ given Euler's method satisfies: $e_n=|y_n-y(t_n)|\leq Dh,D=e^{(b-a)L}\frac{M}{2L}$}

$\cdot$ \textbf{Lemma}: If $v_{n+1}\leq Av_n+B$, then $v_n\leq A^nv_0+\frac{A^n-1}{A-1}B$ \quad If $v_{n}=e_n:=y_n-y(t_n)$, then $A=1+hL,B=h^2M/2$ {\scriptsize (suppose $|y''|<M$)}

\textbf{Order Notation ($\mathcal{O}$)}: we write $z(h)=\mathcal{O}(h^p)$ if $\exists C,h_0>0$ s.t. $|z|\leq Ch^p,0<h<h_0$

\textbf{Flow Map ($\Phi,\Psi$)}: $\Phi_{t_0,h}(y_0)=y(t_0+h)$ \quad Clearly, $\Phi(t_n+h)=y(t_n+h)=\Phi_h(y(t_n))=y(t_{n+1})$.

$\cdot$ $\Psi_{t_n,h}(y_n)=y_{n+1}$:= Numerical method for ODE \quad Clearly, $\Psi(t_n+h)=y_{n+1}=\Psi_h(y_{n})$

\textbf{Taylor Series Method}: {\small Approximate ODE $\frac{dy}{dt}=f(t,y),y(t_0)=y_0$ with \textit{n-order Methods}: 用 Taylor Series 在 $t_0+h$ 处展开 保留到 $n$ 阶}

$\cdot$ $\Phi_{t,h}(y)=y+hf(t,y)+\frac{1}{2}h^2f[f_t(t,y)+f_y(t,y)f(t,y)]+\frac{1}{6}y'''(t,y)h^3+\cdots$

$\cdot$ ps: {\footnotesize Taylor Series: $y(t_0+h)=y(t_0)+hy'(t_0)+\frac{h^2}{2}y''(t_0)+\cdots+\frac{h^{n-1}}{(n-1)!}y^{(n-1)}(t_0)+\frac{h^n}{n!}y^{(n)}(t^*),t^*\in[t,t+h]$ \quad \quad  ps: $y'=f,y''=f_t+f_yf$}


\section{Convergence of One-Step Methods {\scriptsize consider for autonomous $y'=f(y)$}} % Convergence of One-Step Methods

\subsection{Convergence | Consistent | Stable} % Convergence | Consistent | Stable
\textbf{Global Error}: global error after $n$ steps: $e_n:=y_n-y(t_n)$ \quad \textbf{Local Error}: {\small For \textit{one-step} method is: $le(y,h)=\Psi_h(y)-\Phi_h(y)$}

\textbf{Consistent}: {\small If $||le(y,h)||<Ch^{p+1} (<\mathcal{O}(h^{p+1})), \ C>0$. $\Rightarrow$ Consistent at order $p$.} \quad \textbf{Stable}: If $||\Psi_h(u)-\Psi_h(v)||\leq(1+h\widehat{L})||u-v||$

\textbf{Convergent}: {\small A method is convergent if:$\forall \ T$, $\lim\limits_{h\to0,\ h=T/N}\max\limits_{n=0,1,...,N}||e_n||=0$} \quad \quad \quad {\small $\Downarrow$ Then the global error satisfies: $\max\limits_{n=0,1,...,N}||e_n||=\mathcal{O}(h^p)$} \ {\tiny \textbf{p-th order}}

\vspace{-2pt}
\textbf{Convergence of One-Step Method}: {\small For $y'=f(y)$, and a one-step method $\Psi_h(y)$ is $^1$ consistent at order $p$ and $^2$ stable with $\widehat{L}\Uparrow$.} \ {\tiny (ps:$C=\frac{C}{\widehat{L}}(e^{T\widehat{L}}-1)$)}


\subsection{More One-Step Methods | Runge-Kutta Methods | Collocation} % More One-Step Methods | Runge-Kutta Methods | Collocation

\textbf{Construction of More General one-step Method}: For $y'=f(y),y(t_0)=y_0$ \ $\Rightarrow$ \ $y(t+h)-y(t)=\int^{t+h}_tf(y(\tau))d\tau$

\textbf{Trapezoidal Method}: $y_{n+1}=y_n+\frac{h}{2}(f(y_n)+f(y_{n+1}))$ \quad \quad \textbf{Midpoint Method}: {\small $y_{n+1}=y_n+hf(\frac{y_n+y_{n+1}}{2})$}

\textbf{One-Step Collocation Methods (By Lagrange Interpolating Polynomials)}:

\begin{enumerate}[itemsep=-2pt, topsep=-2pt]
    \item \textbf{Lagrange Interpolating Polynomials}: $\ell_{i}(x)=\prod_{j=1,j\ne i}^{s}\frac{x-c_j}{c_i-c_j}\in\mathbb{P}_{s-1}$ \quad where $c_i\in F\in\{\mathbb{Q},\mathbb{R},\mathbb{C}\}$ \\
    $\Rightarrow$ \textbf{Polynomial Interpolation}: $\forall p(x)\in \mathbb{P}_s$ with $p(c_i)=g_i\in F$ \ \ $\Rightarrow$ \ \ $\exists!$ $p(x)=\sum_{i=1}^{s}g_i\ell_i(x)$ {\tiny (Can be proved by Honour Algebra)}
    \item \textbf{Quadrature Rule}: {\scriptsize If $g(t)\in\mathbb{P}_{p-1}\Rightarrow$ Order $p$} \quad $\big|$ \quad {\small $\int^{t_0+h}_{t_0}g(t)dt=\int^1_0g(t_0+hx)dx\approx h\sum_{i=1}^{s}b_ig(t_0+hc_i),b_i:=\int^1_0\ell_i(x)dx$} \quad {\tiny ps: $c_i$ 从 $[0,1]$中取不同的}
    \item \textbf{Collocation Methods}: For: $y(t_0)=y_0 \ , \ y'(t_0+c_ih)=f(y(t_0+c_ih))$ {\tiny ps: $c_i$ 从 $[0,1]$中取不同的} \quad {\scriptsize Let: $a_{ij}:=\int_0^{c_i}\ell_j(x)dx$ and $b_i:=\int_0^1\ell_i(x)dx$}\\
    $\Rightarrow$ \ $F_i=f(y_n+h\sum_{j=1}^{s}a_{ij}F_j)$ and $y_{n+1}=y_n+h\sum_{i=1}^{s}b_iF_i$ \hspace{30pt} where $F_i:=y'(t_0+c_ih)$
\end{enumerate}

$\cdot$ \textbf{Remark}: {\footnotesize For choice of $c_i$: The optimal choice is attained by \textit{Gauss-Legendre collocation methods}}.

\textbf{Runge-Kutta Methods}: Let $y'=f(t,y)$ \quad \textbf{Stage Values}: $Y_i=y_n+h\sum_{j=1}^{s}a_{ij}f(Y_{j})$ \ \ $i\in\{1,...,s\}$ \quad $F_i=f(Y_i)$

\begin{enumerate}[itemsep=-2pt, topsep=-2pt]
    \item The RK method is the form: $y_{n+1}=y_n+h\sum_{i=1}^{s}b_if(t_n+c_i,Y_i)$ \quad for some values of $b_i,a_{ij},s,c_i$ \quad {\scriptsize for Autonomous: $c_i=\sum_{j=1}^{s}a_{ij}$}
    \item Flow-map: $\Psi_{h}(y)=y+h\sum_{i=1}^{s}b_if(t_n+c_i,Y_{i}(y,h))$ \quad \quad \quad {\scriptsize ps:\textit{weights}: $b_i$; \ \textit{internal coefficients}: $a_{ij}$}
    \item \small{{\scriptsize We can using \textbf{Butcher Table} to represent the RK method (Appendix)} \quad \textbf{Explicit}: $a_{ij}=0$ for $j\geq i$ {\scriptsize (严格下三角行)} \quad \textbf{Implicit}: $\exists a_{ij}\ne0$ for $j\geq i$ {\scriptsize (Not Explicit)}}
\end{enumerate}


\subsection{Accuracy of RK Method | Order Condition} % Accuracy of RK Method | Order Condition



\section{Appendix} 

\subsection{Useful Series | Common RK Methods} % Useful Series | Common RK Methods
\small{
$e^x = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \cdots  = \sum_{n=0}^\infty \frac{x^n}{n!}$ \quad $ \sin(x) = x - \frac{x^3}{3!} + \frac{x^5}{5!} + \cdots = \sum_{n=0}^\infty (-1)^n \frac{x^{2n+1}}{(2n+1)!} $ \quad $\cos(x) = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} + \cdots = \sum_{n=0}^\infty (-1)^n \frac{x^{2n}}{(2n)!}$

$\ln(1+x) = x - \frac{x^2}{2} + \frac{x^3}{3}  + \cdots = \sum_{n=1}^\infty (-1)^{n+1} \frac{x^n}{n}$ \quad $\arctan(x) = x - \frac{x^3}{3} + \frac{x^5}{5} + \cdots = \sum_{n=0}^\infty (-1)^n \frac{x^{2n+1}}{2n+1}$ \quad $\sinh(x) = x + \frac{x^3}{3!} + \frac{x^5}{5!} + \cdots = \sum_{n=0}^\infty \frac{x^{2n+1}}{(2n+1)!}$

$\cosh(x) = 1 + \frac{x^2}{2!} + \frac{x^4}{4!} + \cdots = \sum_{n=0}^\infty \frac{x^{2n}}{(2n)!}$  \quad $(1+x)^k = 1 + kx + \frac{k(k-1)x^2}{2!} + \cdots = \sum_{n=0}^\infty \binom{k}{n} x^n$ $\frac{1}{1-x} = 1 + x + x^2  + \cdots = \sum_{n=0}^\infty x^n $ 

$\frac{1}{1+x} = 1 - x + x^2  + \cdots = \sum_{n=0}^\infty (-1)^n x^n$ \quad $\ln(x) = (x-1) - \frac{(x-1)^2}{2} - \cdots = \sum_{n=1}^\infty (-1)^{n+1} \frac{(x-1)^n}{n}, \, x > 0$
}

\textbf{Common Runge-Kutta Methods (Butcher Table)}:

\vspace{-5pt}
\begin{minipage}{0.15\linewidth}
    \centering
    \begin{tabular}{c|ccc}
        $c_1$ & $a_{11}$ & $\cdots$ & $a_{1s}$ \\
        $\vdots$ & $\vdots$ & $\ddots$ & $\vdots$ \\
        $c_s$ & $a_{s1}$ & $\cdots$ & $a_{ss}$ \\
        \hline
            & $b_1$ & $\cdots$ & $b_s$
    \end{tabular}
    \\~\\
    \scriptsize{Example}
\end{minipage}
\hfill
\begin{minipage}{0.15\linewidth}
    \centering
    \begin{tabular}{c|c}
        0 &  \\
        \hline
          & 1
    \end{tabular}
    \\~\\
    \scriptsize{RK1 \\ (Euler's Method)}
\end{minipage}
\hfill
\begin{minipage}{0.15\linewidth}
    \centering
    \begin{tabular}{c|cc}
        0   &    &  \\
        1   & 1   &  \\
        \hline
            & 1/2 & 1/2
    \end{tabular}
    \\~\\
    \scriptsize{RK2 (Heun's Method)}
\end{minipage}
\hfill
\begin{minipage}{0.2\linewidth}
    \centering
    \begin{tabular}{c|ccc}
        0   &    &    &  \\
        1/2 & 1/2 &    &  \\
        1   & -1  & 2   &  \\
        \hline
            & 1/6 & 2/3 & 1/6
    \end{tabular}
    \\~\\
    \scriptsize{RK3}
\end{minipage}
\hfill
\begin{minipage}{0.3\linewidth}
    \centering
    \begin{tabular}{c|cccc}
        0   &    &    &    &  \\
        1/2 & 1/2 &    &    &  \\
        1/2 & 0   & 1/2 &    &  \\
        1   & 0   & 0   & 1   &  \\
        \hline
            & 1/6 & 1/3 & 1/3 & 1/6
    \end{tabular}
    \\~\\
    \scriptsize{RK4 (Classical/Famous)}
\end{minipage}

\end{document}